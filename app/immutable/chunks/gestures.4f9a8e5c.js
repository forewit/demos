var w=Object.defineProperty;var Y=(t,l,s)=>l in t?w(t,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[l]=s;var c=(t,l,s)=>(Y(t,typeof l!="symbol"?l+"":l,s),s);class k{constructor(){c(this,"isMoving",!1);c(this,"isLongclick",!1);c(this,"button",0);c(this,"lastX",0);c(this,"lastY",0);c(this,"consecutiveClicks",0);c(this,"lastMouseupTime",0);c(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class X{constructor(){c(this,"isDragging",!1);c(this,"isPinching",!1);c(this,"isLongpressed",!1);c(this,"consecutiveTaps",0);c(this,"lastTouchendTime",0);c(this,"lastCenterX",0);c(this,"lastCenterY",0);c(this,"identifier",0);c(this,"x",0);c(this,"y",0);c(this,"hypotenuse",0);c(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let o=[],n=new k,e=new X;const i=(t,l)=>{t!=null&&t.dispatchEvent(new CustomEvent("gesture",{detail:l,bubbles:!1,cancelable:!1}))},v=t=>{n.reset(),e.reset(),n.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",m),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",u)},f=t=>{if(window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",m),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",u),n.isMoving)if(n.isMoving=!1,n.isLongclick)n.isLongclick=!1,i(n.activeElement,{name:"longclick-drag-end",x:n.lastX,y:n.lastY});else switch(n.button){case 0:i(n.activeElement,{name:"left-click-drag-end",x:n.lastX,y:n.lastY});break;case 1:i(n.activeElement,{name:"middle-click-drag-end",x:n.lastX,y:n.lastY});break;case 2:i(n.activeElement,{name:"right-click-drag-end",x:n.lastX,y:n.lastY});break}n.isLongclick&&i(n.activeElement,{name:"longclick-release",x:n.lastX,y:n.lastY}),n.reset(),e.isDragging&&(e.isDragging=!1,e.isLongpressed?(e.isLongpressed=!1,i(e.activeElement,{name:"longpress-drag-end",x:e.lastCenterX,y:e.lastCenterY})):i(e.activeElement,{name:"touch-drag-end",x:e.lastCenterX,y:e.lastCenterY})),e.isLongpressed&&i(e.activeElement,{name:"longpress-release",x:e.lastCenterX,y:e.lastCenterY}),e.reset()},h=t=>{i(t.target,{name:"wheel",x:t.clientX,y:t.clientY,event:t})},E=t=>{t.preventDefault(),t.stopPropagation()},y=t=>{document.activeElement!==t.target&&(window.addEventListener("mousemove",d),window.addEventListener("mouseup",m),n.activeElement=t.target,n.lastX=t.clientX,n.lastY=t.clientY,n.isMoving||(n.button=t.button),n.button===0&&window.setTimeout(()=>{Date.now()-n.lastMouseupTime>=500&&!n.isMoving&&(n.isLongclick=!0,i(n.activeElement,{name:"longclick",x:t.clientX,y:t.clientY}))},500),t.preventDefault(),t.stopPropagation())},d=t=>{if(t.movementX===0&&t.movementY===0)return;let l=t.clientX-n.lastX,s=t.clientY-n.lastY;if(!n.isMoving)if(n.isLongclick)i(n.activeElement,{name:"longclick-drag-start",x:t.clientX,y:t.clientY});else switch(n.button){case 0:i(n.activeElement,{name:"left-click-drag-start",x:t.clientX,y:t.clientY});break;case 1:i(n.activeElement,{name:"middle-click-drag-start",x:t.clientX,y:t.clientY});break;case 2:i(n.activeElement,{name:"right-click-drag-start",x:t.clientX,y:t.clientY});break}if(n.isMoving=!0,n.lastX=t.clientX,n.lastY=t.clientY,n.isLongclick)i(n.activeElement,{name:"longclick-dragging",x:t.clientX,y:t.clientY,dx:l,dy:s});else switch(n.button){case 0:i(n.activeElement,{name:"left-click-dragging",x:t.clientX,y:t.clientY,dx:l,dy:s});break;case 1:i(n.activeElement,{name:"middle-click-dragging",x:t.clientX,y:t.clientY,dx:l,dy:s});break;case 2:i(n.activeElement,{name:"right-click-dragging",x:t.clientX,y:t.clientY,dx:l,dy:s});break}},m=t=>{if(window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",m),n.lastMouseupTime=Date.now(),n.isMoving)if(n.isMoving=!1,n.isLongclick)n.isLongclick=!1,i(n.activeElement,{name:"longclick-drag-end",x:n.lastX,y:n.lastY});else switch(n.button){case 0:i(n.activeElement,{name:"left-click-drag-end",x:n.lastX,y:n.lastY});break;case 1:i(n.activeElement,{name:"middle-click-drag-end",x:n.lastX,y:n.lastY});break;case 2:i(n.activeElement,{name:"right-click-drag-end",x:n.lastX,y:n.lastY});break}else n.isLongclick||(t.button===2?i(n.activeElement,{name:"right-click",x:t.clientX,y:t.clientY}):t.button===1?i(n.activeElement,{name:"middle-click",x:t.clientX,y:t.clientY}):(n.consecutiveClicks===0&&i(n.activeElement,{name:"left-click",x:t.clientX,y:t.clientY}),n.consecutiveClicks++,window.setTimeout(()=>{n.consecutiveClicks>1&&i(n.activeElement,{name:"double-click",x:t.clientX,y:t.clientY}),n.consecutiveClicks=0},300)));n.isLongclick&&i(n.activeElement,{name:"longclick-release",x:t.clientX,y:t.clientY}),n.isLongclick=!1},x=t=>{if(t.touches.length>1&&(t.preventDefault(),t.stopPropagation()),document.activeElement!==t.target){if(t.preventDefault(),t.stopPropagation(),t.touches.length>1){if(t.touches[0].identifier===e.identifier)return;e.isPinching=!0}window.addEventListener("touchmove",g,{passive:!1}),window.addEventListener("touchend",u),window.addEventListener("touchcancel",u),e.identifier=t.touches[0].identifier,e.x=t.touches[0].clientX,e.y=t.touches[0].clientY,e.activeElement=t.target,window.setTimeout(()=>{e.isPinching||e.isDragging||Date.now()-e.lastTouchendTime>=500&&(e.isDragging=!1,e.isPinching=!1,e.hypotenuse=null,e.isLongpressed=!0,i(e.activeElement,{name:"longpress",x:e.x,y:e.y}))},500)}},g=t=>{if(t.preventDefault(),t.stopPropagation(),e.isDragging){let l=e.x,s=e.y;e.x=t.touches[0].clientX,e.y=t.touches[0].clientY;let a=e.x-l,r=e.y-s;e.isLongpressed?i(e.activeElement,{name:"longpress-dragging",x:e.x,y:e.y,dx:a,dy:r,force:t.touches[0].force}):i(e.activeElement,{name:"touch-dragging",x:e.x,y:e.y,dx:a,dy:r,force:t.touches[0].force});return}else if(!e.isLongpressed&&(e.isPinching||t.touches.length>1)){e.x=t.touches[0].clientX,e.y=t.touches[0].clientY;let l={x:t.touches[1].clientX,y:t.touches[1].clientY},s={x:(e.x+l.x)/2,y:(e.y+l.y)/2},a=Math.hypot(e.x-l.x,e.y-l.y);e.hypotenuse===null&&(e.hypotenuse=a,e.lastCenterX=s.x,e.lastCenterY=s.y,i(e.activeElement,{name:"pinch-start",x:s.x,y:s.y})),e.isPinching=!0;let r=a/e.hypotenuse,L=s.x-e.lastCenterX,p=s.y-e.lastCenterY;i(e.activeElement,{name:"pinching",x:s.x,y:s.y,zoom:r,dx:L,dy:p}),e.hypotenuse=a,e.lastCenterX=s.x,e.lastCenterY=s.y;return}else e.isDragging=!0,e.isLongpressed?(i(e.activeElement,{name:"longpress-drag-start",x:e.x,y:e.y,force:t.touches[0].force}),e.x=t.touches[0].clientX,e.y=t.touches[0].clientY,i(e.activeElement,{name:"longpress-dragging",x:e.x,y:e.y,dx:0,dy:0,force:t.touches[0].force})):(i(e.activeElement,{name:"touch-drag-start",x:e.x,y:e.y,force:t.touches[0].force}),e.x=t.touches[0].clientX,e.y=t.touches[0].clientY,i(e.activeElement,{name:"touch-dragging",x:e.x,y:e.y,dx:0,dy:0,force:t.touches[0].force}))},u=t=>{e.isDragging&&t.touches.length>0&&t.touches[0].identifier===e.identifier||(e.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",u),window.removeEventListener("touchcancel",u),e.isDragging?(e.isDragging=!1,e.isLongpressed?(e.isLongpressed=!1,i(e.activeElement,{name:"longpress-drag-end",x:e.x,y:e.y})):i(e.activeElement,{name:"touch-drag-end",x:e.x,y:e.y})):e.isPinching?(e.isPinching=!1,e.hypotenuse=null,i(e.activeElement,{name:"pinch-end",x:e.lastCenterX,y:e.lastCenterY})):e.isLongpressed||(e.consecutiveTaps===0&&i(e.activeElement,{name:"tap",x:e.x,y:e.y}),e.consecutiveTaps++,window.setTimeout(()=>{e.consecutiveTaps>1&&i(e.activeElement,{name:"double-tap",x:e.x,y:e.y}),e.consecutiveTaps=0},300)),e.isLongpressed&&i(e.activeElement,{name:"longpress-release",x:e.x,y:e.y}),e.isLongpressed=!1)};function D(...t){for(let l of t)o.findIndex(s=>s===l)===-1&&(o.length==0&&(window.addEventListener("blur",f),window.addEventListener("focus",v)),o.push(l),l.addEventListener("touchstart",x,{passive:!1}),l.addEventListener("mousedown",y,{passive:!1}),l.addEventListener("contextmenu",E,{passive:!1}),l.addEventListener("wheel",h,{passive:!1}))}function b(...t){const l=s=>{s.removeEventListener("touchstart",x),s.removeEventListener("mousedown",y),s.removeEventListener("contextmenu",E),s.removeEventListener("wheel",h)};if(t.length==0){for(let s of o)l(s);o=[]}else for(let s of t){let a=o.findIndex(r=>r===s);a!==-1&&(l(s),o.splice(a,1))}o.length==0&&(window.removeEventListener("blur",f),window.removeEventListener("focus",v))}export{b as d,D as e};
