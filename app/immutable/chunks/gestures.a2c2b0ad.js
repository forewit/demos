var p=Object.defineProperty;var Y=(e,l,s)=>l in e?p(e,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[l]=s;var c=(e,l,s)=>(Y(e,typeof l!="symbol"?l+"":l,s),s);class k{constructor(){c(this,"isMoving",!1);c(this,"isLongclick",!1);c(this,"button",0);c(this,"lastX",0);c(this,"lastY",0);c(this,"consecutiveClicks",0);c(this,"lastMouseupTime",0);c(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class X{constructor(){c(this,"isDragging",!1);c(this,"isPinching",!1);c(this,"isLongpressed",!1);c(this,"consecutiveTaps",0);c(this,"lastTouchendTime",0);c(this,"lastCenterX",0);c(this,"lastCenterY",0);c(this,"identifier",0);c(this,"x",0);c(this,"y",0);c(this,"hypotenuse",0);c(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let o=[],n=new k,t=new X;const i=(e,l)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:l,bubbles:!1,cancelable:!1}))},g=e=>{n.reset(),t.reset(),n.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",u),window.removeEventListener("touchmove",m),window.removeEventListener("touchend",d)},y=e=>{if(window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",u),window.removeEventListener("touchmove",m),window.removeEventListener("touchend",d),n.isMoving)if(n.isMoving=!1,n.isLongclick)n.isLongclick=!1,i(n.activeElement,{event:e,name:"longclick-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});else switch(n.button){case 0:i(n.activeElement,{event:e,name:"left-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break;case 1:i(n.activeElement,{event:e,name:"middle-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break;case 2:i(n.activeElement,{event:e,name:"right-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break}n.isLongclick&&i(n.activeElement,{event:e,name:"longclick-release",x:n.lastX,y:n.lastY,dx:0,dy:0}),n.reset(),t.isDragging&&(t.isDragging=!1,t.isLongpressed?(t.isLongpressed=!1,i(t.activeElement,{event:e,name:"longpress-drag-end",x:t.lastCenterX,y:t.lastCenterY,dx:0,dy:0})):i(t.activeElement,{event:e,name:"touch-drag-end",x:t.lastCenterX,y:t.lastCenterY,dx:0,dy:0})),t.isLongpressed&&i(t.activeElement,{event:e,name:"longpress-release",x:t.lastCenterX,y:t.lastCenterY,dx:0,dy:0}),t.reset()},h=e=>{i(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},x=e=>{},f=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",u),n.activeElement=e.target,n.lastX=e.clientX,n.lastY=e.clientY,n.isMoving||(n.button=e.button),n.button===0&&window.setTimeout(()=>{Date.now()-n.lastMouseupTime>=500&&!n.isMoving&&(n.isLongclick=!0,i(n.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},500))},v=e=>{if(e.movementX===0&&e.movementY===0)return;let l=e.clientX-n.lastX,s=e.clientY-n.lastY;if(!n.isMoving)if(n.isLongclick)i(n.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(n.button){case 0:i(n.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:i(n.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:i(n.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(n.isMoving=!0,n.lastX=e.clientX,n.lastY=e.clientY,n.isLongclick)i(n.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:l,dy:s});else switch(n.button){case 0:i(n.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:l,dy:s});break;case 1:i(n.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:l,dy:s});break;case 2:i(n.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:l,dy:s});break}},u=e=>{if(window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",u),n.lastMouseupTime=Date.now(),n.isMoving)if(n.isMoving=!1,n.isLongclick)n.isLongclick=!1,i(n.activeElement,{event:e,name:"longclick-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});else switch(n.button){case 0:i(n.activeElement,{event:e,name:"left-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break;case 1:i(n.activeElement,{event:e,name:"middle-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break;case 2:i(n.activeElement,{event:e,name:"right-click-drag-end",x:n.lastX,y:n.lastY,dx:0,dy:0});break}else n.isLongclick||(e.button===2?i(n.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?i(n.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(n.consecutiveClicks===0&&i(n.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),n.consecutiveClicks++,window.setTimeout(()=>{n.consecutiveClicks>1&&i(n.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),n.consecutiveClicks=0},300)));n.isLongclick&&i(n.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),n.isLongclick=!1},E=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===t.identifier)return;t.isPinching=!0}window.addEventListener("touchmove",m,{passive:!1}),window.addEventListener("touchend",d),window.addEventListener("touchcancel",d),t.identifier=e.touches[0].identifier,t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,t.activeElement=e.target,window.setTimeout(()=>{t.isPinching||t.isDragging||Date.now()-t.lastTouchendTime>=500&&(t.isDragging=!1,t.isPinching=!1,t.hypotenuse=null,t.isLongpressed=!0,i(t.activeElement,{event:e,name:"longpress",x:t.x,y:t.y,dx:0,dy:0}))},500)}},m=e=>{if(t.isDragging){let l=t.x,s=t.y;t.x=e.touches[0].clientX,t.y=e.touches[0].clientY;let a=t.x-l,r=t.y-s;t.isLongpressed?i(t.activeElement,{event:e,name:"longpress-dragging",x:t.x,y:t.y,dx:a,dy:r,force:e.touches[0].force}):i(t.activeElement,{event:e,name:"touch-dragging",x:t.x,y:t.y,dx:a,dy:r,force:e.touches[0].force});return}else if(!t.isLongpressed&&(t.isPinching||e.touches.length>1)){t.x=e.touches[0].clientX,t.y=e.touches[0].clientY;let l={x:e.touches[1].clientX,y:e.touches[1].clientY},s={x:(t.x+l.x)/2,y:(t.y+l.y)/2},a=Math.hypot(t.x-l.x,t.y-l.y);t.hypotenuse===null&&(t.hypotenuse=a,t.lastCenterX=s.x,t.lastCenterY=s.y,i(t.activeElement,{event:e,name:"pinch-start",x:s.x,y:s.y,dx:0,dy:0})),t.isPinching=!0;let r=a/t.hypotenuse,L=s.x-t.lastCenterX,w=s.y-t.lastCenterY;i(t.activeElement,{event:e,name:"pinching",x:s.x,y:s.y,zoom:r,dx:L,dy:w}),t.hypotenuse=a,t.lastCenterX=s.x,t.lastCenterY=s.y;return}else t.isDragging=!0,t.isLongpressed?(i(t.activeElement,{event:e,name:"longpress-drag-start",x:t.x,y:t.y,dx:0,dy:0,force:e.touches[0].force}),t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,i(t.activeElement,{event:e,name:"longpress-dragging",x:t.x,y:t.y,dx:0,dy:0,force:e.touches[0].force})):(i(t.activeElement,{event:e,name:"touch-drag-start",x:t.x,y:t.y,dx:0,dy:0,force:e.touches[0].force}),t.x=e.touches[0].clientX,t.y=e.touches[0].clientY,i(t.activeElement,{event:e,name:"touch-dragging",x:t.x,y:t.y,dx:0,dy:0,force:e.touches[0].force}))},d=e=>{t.isDragging&&e.touches.length>0&&e.touches[0].identifier===t.identifier||(t.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",m),window.removeEventListener("touchend",d),window.removeEventListener("touchcancel",d),t.isDragging?(t.isDragging=!1,t.isLongpressed?(t.isLongpressed=!1,i(t.activeElement,{event:e,name:"longpress-drag-end",x:t.x,y:t.y,dx:0,dy:0})):i(t.activeElement,{event:e,name:"touch-drag-end",x:t.x,y:t.y,dx:0,dy:0})):t.isPinching?(t.isPinching=!1,t.hypotenuse=null,i(t.activeElement,{event:e,name:"pinch-end",x:t.lastCenterX,y:t.lastCenterY,dx:0,dy:0})):t.isLongpressed||(t.consecutiveTaps===0&&i(t.activeElement,{event:e,name:"tap",x:t.x,y:t.y,dx:0,dy:0}),t.consecutiveTaps++,window.setTimeout(()=>{t.consecutiveTaps>1&&i(t.activeElement,{event:e,name:"double-tap",x:t.x,y:t.y,dx:0,dy:0}),t.consecutiveTaps=0},300)),t.isLongpressed&&i(t.activeElement,{event:e,name:"longpress-release",x:t.x,y:t.y,dx:0,dy:0}),t.isLongpressed=!1)};function b(...e){for(let l of e)o.findIndex(s=>s===l)===-1&&(o.length==0&&(window.addEventListener("blur",y),window.addEventListener("focus",g)),o.push(l),l.addEventListener("touchstart",E,{passive:!1}),l.addEventListener("mousedown",f,{passive:!1}),l.addEventListener("contextmenu",x,{passive:!1}),l.addEventListener("wheel",h,{passive:!1}))}function D(...e){const l=s=>{s.removeEventListener("touchstart",E),s.removeEventListener("mousedown",f),s.removeEventListener("contextmenu",x),s.removeEventListener("wheel",h)};if(e.length==0){for(let s of o)l(s);o=[]}else for(let s of e){let a=o.findIndex(r=>r===s);a!==-1&&(l(s),o.splice(a,1))}o.length==0&&(window.removeEventListener("blur",y),window.removeEventListener("focus",g))}export{D as d,b as e};
