import{S as _,i as g,s as p,C as m,F as $,G as h,H as S,g as C,d as D,o as b}from"../chunks/index.38a6999c.js";import{a as L,b as l,d as c,c as f,g as w,s as y}from"../chunks/authStore.478422a7.js";function F(o){let a;const r=o[1].default,e=m(r,o,o[0],null);return{c(){e&&e.c()},l(t){e&&e.l(t)},m(t,s){e&&e.m(t,s),a=!0},p(t,[s]){e&&e.p&&(!a||s&1)&&$(e,r,t,t[0],a?S(r,t[0],s,null):h(t[0]),null)},i(t){a||(C(e,t),a=!0)},o(t){D(e,t),a=!1},d(t){e&&e.d(t)}}}function R(o,a,r){let{$$slots:e={},$$scope:t}=a;return b(()=>{L.onAuthStateChanged(async s=>{if(!s){l.update(n=>({...n,isLoading:!1,currentUser:s}));return}const d=c(f,"users",s.uid),u=await w(d);let i={text:""};if(u.exists())console.log("Fetching firestore user doc..."),i=u.data();else{console.log("Creating firestore user doc...");const n=c(f,"users",s.uid);await y(n,i,{merge:!0})}l.update(n=>({...n,isLoading:!1,currentUser:s,data:i}))})}),o.$$set=s=>{"$$scope"in s&&r(0,t=s.$$scope)},[t,e]}class q extends _{constructor(a){super(),g(this,a,R,F,p,{})}}export{q as component};
