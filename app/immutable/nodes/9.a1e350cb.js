var Ee=Object.defineProperty;var be=(e,t,i)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var _=(e,t,i)=>(be(e,typeof t!="symbol"?t+"":t,i),i);import{S as K,i as W,s as J,k as w,l as L,m as D,h as k,n as E,b,J as Y,o as we,w as he,R as Le,q as Q,a as V,e as ne,r as F,c as G,E as Z,u as ge,Q as me,O as x,T as M,P as A,N as C,y as ie,D as xe,z as se,A as le,g as ae,d as oe,B as re}from"../chunks/index.513dcc03.js";const ce=500,Ye=300,ue=500,Ce=300;class Xe{constructor(){_(this,"isMoving",!1);_(this,"isLongclick",!1);_(this,"button",0);_(this,"lastX",0);_(this,"lastY",0);_(this,"consecutiveClicks",0);_(this,"lastMouseupTime",0);_(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class De{constructor(){_(this,"isDragging",!1);_(this,"isPinching",!1);_(this,"isLongpressed",!1);_(this,"consecutiveTaps",0);_(this,"lastTouchendTime",0);_(this,"lastCenterX",0);_(this,"lastCenterY",0);_(this,"identifier",0);_(this,"x",0);_(this,"y",0);_(this,"hypotenuse",0);_(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let U=[],l=new Xe,n=new De;const d=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},Te=e=>{l.reset(),n.reset(),l.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",z),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",X)},Pe=e=>{if(window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",z),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",X),l.isMoving)if(l.isMoving=!1,l.isLongclick)l.isLongclick=!1,d(l.activeElement,{name:"longclick-drag-end",x:l.lastX,y:l.lastY});else switch(l.button){case 0:d(l.activeElement,{name:"left-click-drag-end",x:l.lastX,y:l.lastY});break;case 1:d(l.activeElement,{name:"middle-click-drag-end",x:l.lastX,y:l.lastY});break;case 2:d(l.activeElement,{name:"right-click-drag-end",x:l.lastX,y:l.lastY});break}l.isLongclick&&d(l.activeElement,{name:"longclick-release",x:l.lastX,y:l.lastY}),l.reset(),n.isDragging&&(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.lastCenterX,y:n.lastCenterY})):d(n.activeElement,{name:"touch-drag-end",x:n.lastCenterX,y:n.lastCenterY})),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.lastCenterX,y:n.lastCenterY}),n.reset()},Ie=e=>{d(e.target,{name:"wheel",x:e.clientX,y:e.clientY,event:e}),e.preventDefault(),e.stopPropagation()},Me=e=>{e.preventDefault(),e.stopPropagation()},Se=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",O),window.addEventListener("mouseup",z),l.activeElement=e.target,l.lastX=e.clientX,l.lastY=e.clientY,l.isMoving||(l.button=e.button),l.button===0&&window.setTimeout(()=>{Date.now()-l.lastMouseupTime>=ue&&!l.isMoving&&(l.isLongclick=!0,d(l.activeElement,{name:"longclick",x:e.clientX,y:e.clientY}))},ue),e.preventDefault(),e.stopPropagation())},O=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-l.lastX,i=e.clientY-l.lastY;if(!l.isMoving)if(l.isLongclick)d(l.activeElement,{name:"longclick-drag-start",x:e.clientX,y:e.clientY});else switch(l.button){case 0:d(l.activeElement,{name:"left-click-drag-start",x:e.clientX,y:e.clientY});break;case 1:d(l.activeElement,{name:"middle-click-drag-start",x:e.clientX,y:e.clientY});break;case 2:d(l.activeElement,{name:"right-click-drag-start",x:e.clientX,y:e.clientY});break}if(l.isMoving=!0,l.lastX=e.clientX,l.lastY=e.clientY,l.isLongclick)d(l.activeElement,{name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});else switch(l.button){case 0:d(l.activeElement,{name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 1:d(l.activeElement,{name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 2:d(l.activeElement,{name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break}},z=e=>{if(window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",z),l.lastMouseupTime=Date.now(),l.isMoving)if(l.isMoving=!1,l.isLongclick)l.isLongclick=!1,d(l.activeElement,{name:"longclick-drag-end",x:l.lastX,y:l.lastY});else switch(l.button){case 0:d(l.activeElement,{name:"left-click-drag-end",x:l.lastX,y:l.lastY});break;case 1:d(l.activeElement,{name:"middle-click-drag-end",x:l.lastX,y:l.lastY});break;case 2:d(l.activeElement,{name:"right-click-drag-end",x:l.lastX,y:l.lastY});break}else l.isLongclick||(e.button===2?d(l.activeElement,{name:"right-click",x:e.clientX,y:e.clientY}):e.button===1?d(l.activeElement,{name:"middle-click",x:e.clientX,y:e.clientY}):(l.consecutiveClicks===0&&d(l.activeElement,{name:"left-click",x:e.clientX,y:e.clientY}),l.consecutiveClicks++,window.setTimeout(()=>{l.consecutiveClicks>1&&d(l.activeElement,{name:"double-click",x:e.clientX,y:e.clientY}),l.consecutiveClicks=0},Ce)));l.isLongclick&&d(l.activeElement,{name:"longclick-release",x:e.clientX,y:e.clientY}),l.isLongclick=!1},He=e=>{if(e.touches.length>1&&(e.preventDefault(),e.stopPropagation()),document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===n.identifier)return;n.isPinching=!0}window.addEventListener("touchmove",j,{passive:!1}),window.addEventListener("touchend",X),window.addEventListener("touchcancel",X),n.identifier=e.touches[0].identifier,n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,n.activeElement=e.target,window.setTimeout(()=>{n.isPinching||n.isDragging||Date.now()-n.lastTouchendTime>=ce&&(n.isDragging=!1,n.isPinching=!1,n.hypotenuse=null,n.isLongpressed=!0,d(n.activeElement,{name:"longpress",x:n.x,y:n.y}))},ce)}},j=e=>{if(e.preventDefault(),e.stopPropagation(),n.isDragging){let t=n.x,i=n.y;n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let s=n.x-t,r=n.y-i;n.isLongpressed?d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:s,dy:r}):d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:s,dy:r});return}else if(!n.isLongpressed&&(n.isPinching||e.touches.length>1)){n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},i={x:(n.x+t.x)/2,y:(n.y+t.y)/2},s=Math.hypot(n.x-t.x,n.y-t.y);n.hypotenuse===null&&(n.hypotenuse=s,n.lastCenterX=i.x,n.lastCenterY=i.y,d(n.activeElement,{name:"pinch-start",x:i.x,y:i.y})),n.isPinching=!0;let r=s/n.hypotenuse,a=i.x-n.lastCenterX,o=i.y-n.lastCenterY;d(n.activeElement,{name:"pinching",x:i.x,y:i.y,zoom:r,dx:a,dy:o}),n.hypotenuse=s,n.lastCenterX=i.x,n.lastCenterY=i.y;return}else n.isDragging=!0,n.isLongpressed?(d(n.activeElement,{name:"longpress-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:0,dy:0})):(d(n.activeElement,{name:"touch-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:0,dy:0}))},X=e=>{n.isDragging&&e.touches.length>0&&e.touches[0].identifier===n.identifier||(n.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",X),window.removeEventListener("touchcancel",X),n.isDragging?(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.x,y:n.y})):d(n.activeElement,{name:"touch-drag-end",x:n.x,y:n.y})):n.isPinching?(n.isPinching=!1,n.hypotenuse=null,d(n.activeElement,{name:"pinch-end",x:n.lastCenterX,y:n.lastCenterY})):n.isLongpressed||(n.consecutiveTaps===0&&d(n.activeElement,{name:"tap",x:n.x,y:n.y}),n.consecutiveTaps++,window.setTimeout(()=>{n.consecutiveTaps>1&&d(n.activeElement,{name:"double-tap",x:n.x,y:n.y}),n.consecutiveTaps=0},Ye)),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.x,y:n.y}),n.isLongpressed=!1)};function Ne(...e){for(let t of e)U.findIndex(i=>i===t)===-1&&(U.length==0&&(window.addEventListener("blur",Pe),window.addEventListener("focus",Te)),U.push(t),t.addEventListener("touchstart",He,{passive:!1}),t.addEventListener("mousedown",Se,{passive:!1}),t.addEventListener("contextmenu",Me,{passive:!1}),t.addEventListener("wheel",Ie,{passive:!1}))}function Ae(e){let t;return{c(){t=w("canvas"),this.h()},l(i){t=L(i,"CANVAS",{id:!0,class:!0}),D(t).forEach(k),this.h()},h(){E(t,"id","canvas"),E(t,"class","svelte-16hz5p5")},m(i,s){b(i,t,s),e[7](t)},p:Y,i:Y,o:Y,d(i){i&&k(t),e[7](null)}}}function Oe(e,t,i){let s,{radius:r=1}=t,{stroke:a=5}=t,{lineCap:o="round"}=t,{color:p="#000000"}=t,{dashed:c=!1}=t;function u(){m.clearRect(0,0,B,q)}let h,m,g={x:0,y:0},q=0,B=0,T,S=!1,H,R=[],$=function(f,v,y,N){var P=y-f,I=N-v;return Math.sqrt(P*P+I*I)};async function pe(){console.log("resizing"),await te(),T=window.devicePixelRatio;let f=h.getBoundingClientRect();q=f.height*T,B=f.width*T,i(0,h.width=B,h),i(0,h.height=q,h);for(let v=0;v<R.length;v++)ve(R[v])}function ve(f){m.lineWidth=f.stroke,m.lineCap=f.lineCap,m.strokeStyle=f.color,m.setLineDash(f.dash),m.beginPath(),m.moveTo(f.points[0].x,f.points[0].y);for(let v=1;v<f.points.length;v=v+2)m.quadraticCurveTo(f.points[v-1].x,f.points[v-1].y,f.points[v].x,f.points[v].y),m.stroke()}function ee(f,v){let y=h.getBoundingClientRect();return{x:(f-y.left)*T,y:(v-y.top)*T}}function ye(f,v){S=!0,H={points:[],stroke:a,lineCap:o,color:p,dash:s},m.lineWidth=a,m.lineCap=o,m.strokeStyle=p,m.setLineDash(s),m.beginPath(),g=ee(f,v),m.moveTo(g.x,g.y),H.points.push(g)}function _e(f,v){if(!S)return;let y=ee(f,v);if(r>0){if($(y.x,y.y,g.x,g.y)<=r)return;let I=Math.sqrt(y.x*y.x+y.y*y.y-2*y.x*g.x+g.x*g.x-2*y.y*g.y+g.y*g.y);if(y={x:y.x+r*((g.x-y.x)/I),y:y.y+r*((g.y-y.y)/I)},$(g.x,g.y,y.x,y.y)<=10)return}var N=(g.x+y.x)/2,P=(g.y+y.y)/2;m.quadraticCurveTo(g.x,g.y,N,P),g=y,m.stroke(),H.points.push({x:N,y:P},y)}function te(){S&&R.push(H),S=!1}we(()=>{m=h.getContext("2d"),m.imageSmoothingEnabled=!1,Ne(h),h.addEventListener("gesture",v=>{switch(v.detail.name){case"left-click-drag-start":case"touch-drag-start":ye(v.detail.x,v.detail.y);break;case"left-click-dragging":case"touch-dragging":_e(v.detail.x,v.detail.y);break;case"left-click-drag-end":case"tough-drag-end":te();break}}),new ResizeObserver(pe).observe(h)});function ke(f){he[f?"unshift":"push"](()=>{h=f,i(0,h)})}return e.$$set=f=>{"radius"in f&&i(1,r=f.radius),"stroke"in f&&i(2,a=f.stroke),"lineCap"in f&&i(3,o=f.lineCap),"color"in f&&i(4,p=f.color),"dashed"in f&&i(5,c=f.dashed)},e.$$.update=()=>{e.$$.dirty&36&&(s=c?[a,a*3]:[])},[h,r,a,o,p,c,u,ke]}class ze extends K{constructor(t){super(),W(this,t,Oe,Ae,J,{radius:1,stroke:2,lineCap:3,color:4,dashed:5,clear:6})}get clear(){return this.$$.ctx[6]}}function de(e,t,i){const s=e.slice();return s[5]=t[i],s[6]=t,s[7]=i,s}function je(e){let t,i;return{c(){t=w("div"),i=Q("Invalid input type!")},l(s){t=L(s,"DIV",{});var r=D(t);i=F(r,"Invalid input type!"),r.forEach(k)},m(s,r){b(s,t,r),Z(t,i)},p:Y,d(s){s&&k(t)}}}function qe(e){let t,i=e[5].label+"",s,r,a;return{c(){t=w("button"),s=Q(i),this.h()},l(o){t=L(o,"BUTTON",{id:!0,class:!0});var p=D(t);s=F(p,i),p.forEach(k),this.h()},h(){E(t,"id",e[7].toString()),E(t,"class","svelte-1h1fjxy")},m(o,p){b(o,t,p),Z(t,s),r||(a=x(t,"click",function(){M(e[5].onClick())&&e[5].onClick().apply(this,arguments)}),r=!0)},p(o,p){e=o,p&1&&i!==(i=e[5].label+"")&&ge(s,i)},d(o){o&&k(t),r=!1,a()}}}function Be(e){let t,i,s;function r(){e[4].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){E(t,"id",e[7].toString()),E(t,"type","checkbox"),E(t,"class","svelte-1h1fjxy")},m(a,o){b(a,t,o),t.checked=e[5].value,i||(s=[x(t,"change",r),x(t,"input",function(){M(e[5].onInput(!e[5].value))&&e[5].onInput(!e[5].value).apply(this,arguments)})],i=!0)},p(a,o){e=a,o&1&&(t.checked=e[5].value)},d(a){a&&k(t),i=!1,A(s)}}}function Re(e){let t,i,s;function r(){e[3].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){E(t,"id",e[7].toString()),E(t,"type","color"),E(t,"class","svelte-1h1fjxy")},m(a,o){b(a,t,o),C(t,e[5].value),i||(s=[x(t,"input",r),x(t,"input",function(){M(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,o){e=a,o&1&&C(t,e[5].value)},d(a){a&&k(t),i=!1,A(s)}}}function Ue(e){let t,i,s;function r(){e[2].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){E(t,"id",e[7].toString()),E(t,"type","text"),E(t,"class","svelte-1h1fjxy")},m(a,o){b(a,t,o),C(t,e[5].value),i||(s=[x(t,"input",r),x(t,"input",function(){M(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,o){e=a,o&1&&t.value!==e[5].value&&C(t,e[5].value)},d(a){a&&k(t),i=!1,A(s)}}}function Ve(e){let t,i,s;function r(){e[1].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){E(t,"id",e[7].toString()),E(t,"type","number"),E(t,"class","svelte-1h1fjxy")},m(a,o){b(a,t,o),C(t,e[5].value),i||(s=[x(t,"input",r),x(t,"input",function(){M(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,o){e=a,o&1&&me(t.value)!==e[5].value&&C(t,e[5].value)},d(a){a&&k(t),i=!1,A(s)}}}function fe(e){let t,i=e[5].title+"",s,r,a;function o(u,h){return u[5].type=="number"?Ve:u[5].type=="string"?Ue:u[5].type=="color"?Re:u[5].type=="checkbox"?Be:u[5].type=="button"?qe:je}let p=o(e),c=p(e);return{c(){t=w("label"),s=Q(i),r=V(),c.c(),a=ne(),this.h()},l(u){t=L(u,"LABEL",{for:!0,class:!0});var h=D(t);s=F(h,i),h.forEach(k),r=G(u),c.l(u),a=ne(),this.h()},h(){E(t,"for",e[7].toString()),E(t,"class","svelte-1h1fjxy")},m(u,h){b(u,t,h),Z(t,s),b(u,r,h),c.m(u,h),b(u,a,h)},p(u,h){h&1&&i!==(i=u[5].title+"")&&ge(s,i),p===(p=o(u))&&c?c.p(u,h):(c.d(1),c=p(u),c&&(c.c(),c.m(a.parentNode,a)))},d(u){u&&k(t),u&&k(r),c.d(u),u&&k(a)}}}function Ge(e){let t,i=e[0],s=[];for(let r=0;r<i.length;r+=1)s[r]=fe(de(e,i,r));return{c(){t=w("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){t=L(r,"DIV",{class:!0});var a=D(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(k),this.h()},h(){E(t,"class","container svelte-1h1fjxy")},m(r,a){b(r,t,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,[a]){if(a&1){i=r[0];let o;for(o=0;o<i.length;o+=1){const p=de(r,i,o);s[o]?s[o].p(p,a):(s[o]=fe(p),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:Y,o:Y,d(r){r&&k(t),Le(s,r)}}}function Ke(e,t,i){let{props:s}=t;function r(c,u){c[u].value=me(this.value),i(0,s)}function a(c,u){c[u].value=this.value,i(0,s)}function o(c,u){c[u].value=this.value,i(0,s)}function p(c,u){c[u].value=this.checked,i(0,s)}return e.$$set=c=>{"props"in c&&i(0,s=c.props)},[s,r,a,o,p]}class We extends K{constructor(t){super(),W(this,t,Ke,Ge,J,{props:0})}}function Je(e){let t,i,s,r,a,o;s=new We({props:{props:[{title:"Stroke",type:"number",onInput:e[4],value:e[1]},{title:"Color",type:"color",onInput:e[5],value:e[2]},{title:"Dashed",type:"checkbox",onInput:e[6],value:e[3]},{title:"Clear",type:"button",onClick:e[7],label:"🧹"}]}});let p={dashed:e[3],color:e[2],stroke:e[1]};return a=new ze({props:p}),e[8](a),{c(){t=V(),i=w("div"),ie(s.$$.fragment),r=V(),ie(a.$$.fragment),this.h()},l(c){xe("svelte-94kuob",document.head).forEach(k),t=G(c),i=L(c,"DIV",{class:!0});var h=D(i);se(s.$$.fragment,h),h.forEach(k),r=G(c),se(a.$$.fragment,c),this.h()},h(){document.title="Draw",E(i,"class","inputs-container svelte-igcq23")},m(c,u){b(c,t,u),b(c,i,u),le(s,i,null),b(c,r,u),le(a,c,u),o=!0},p(c,[u]){const h={};u&15&&(h.props=[{title:"Stroke",type:"number",onInput:c[4],value:c[1]},{title:"Color",type:"color",onInput:c[5],value:c[2]},{title:"Dashed",type:"checkbox",onInput:c[6],value:c[3]},{title:"Clear",type:"button",onClick:c[7],label:"🧹"}]),s.$set(h);const m={};u&8&&(m.dashed=c[3]),u&4&&(m.color=c[2]),u&2&&(m.stroke=c[1]),a.$set(m)},i(c){o||(ae(s.$$.fragment,c),ae(a.$$.fragment,c),o=!0)},o(c){oe(s.$$.fragment,c),oe(a.$$.fragment,c),o=!1},d(c){c&&k(t),c&&k(i),re(s),c&&k(r),e[8](null),re(a,c)}}}function Qe(e,t,i){let s,r=5,a="#ff0000",o=!1;const p=g=>{g!=null&&i(1,r=g)},c=g=>{g!=null&&i(2,a=g)},u=g=>{g!=null&&i(3,o=g)},h=()=>{s.clear()};function m(g){he[g?"unshift":"push"](()=>{s=g,i(0,s)})}return[s,r,a,o,p,c,u,h,m]}class et extends K{constructor(t){super(),W(this,t,Qe,Je,J,{})}}export{et as component};
