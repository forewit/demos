var he=Object.defineProperty;var me=(e,t,i)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var p=(e,t,i)=>(me(e,typeof t!="symbol"?t+"":t,i),i);import{S as R,i as U,s as q,k as w,l as b,m as T,h as y,n as _,b as k,J as x,o as ge,w as pe,R as ve,q as le,a as z,e as Q,r as ae,c as B,E as oe,u as ye,Q as ce,O as L,T as I,P as M,N as Y,y as W,D as _e,z as j,A as F,g as Z,d as $,B as ee}from"../chunks/index.513dcc03.js";const te=500,Ee=300,ne=500,ke=300;class we{constructor(){p(this,"isMoving",!1);p(this,"isLongclick",!1);p(this,"button",0);p(this,"lastX",0);p(this,"lastY",0);p(this,"consecutiveClicks",0);p(this,"lastMouseupTime",0);p(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class be{constructor(){p(this,"isDragging",!1);p(this,"isPinching",!1);p(this,"isLongpressed",!1);p(this,"consecutiveTaps",0);p(this,"lastTouchendTime",0);p(this,"lastCenterX",0);p(this,"lastCenterY",0);p(this,"identifier",0);p(this,"x",0);p(this,"y",0);p(this,"hypotenuse",0);p(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let O=[],s=new we,n=new be;const d=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},Le=e=>{s.reset(),n.reset(),s.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",H),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",X)},xe=e=>{if(window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",H),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",X),s.isMoving)if(s.isMoving=!1,s.isLongclick)s.isLongclick=!1,d(s.activeElement,{name:"longclick-drag-end",x:s.lastX,y:s.lastY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-end",x:s.lastX,y:s.lastY});break;case 1:d(s.activeElement,{name:"middle-click-drag-end",x:s.lastX,y:s.lastY});break;case 2:d(s.activeElement,{name:"right-click-drag-end",x:s.lastX,y:s.lastY});break}s.isLongclick&&d(s.activeElement,{name:"longclick-release",x:s.lastX,y:s.lastY}),s.reset(),n.isDragging&&(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.lastCenterX,y:n.lastCenterY})):d(n.activeElement,{name:"touch-drag-end",x:n.lastCenterX,y:n.lastCenterY})),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.lastCenterX,y:n.lastCenterY}),n.reset()},Ye=e=>{d(e.target,{name:"wheel",x:e.clientX,y:e.clientY,event:e}),e.preventDefault(),e.stopPropagation()},Xe=e=>{e.preventDefault(),e.stopPropagation()},Ce=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",S),window.addEventListener("mouseup",H),s.activeElement=e.target,s.lastX=e.clientX,s.lastY=e.clientY,s.isMoving||(s.button=e.button),s.button===0&&window.setTimeout(()=>{Date.now()-s.lastMouseupTime>=ne&&!s.isMoving&&(s.isLongclick=!0,d(s.activeElement,{name:"longclick",x:e.clientX,y:e.clientY}))},ne),e.preventDefault(),e.stopPropagation())},S=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-s.lastX,i=e.clientY-s.lastY;if(!s.isMoving)if(s.isLongclick)d(s.activeElement,{name:"longclick-drag-start",x:e.clientX,y:e.clientY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-start",x:e.clientX,y:e.clientY});break;case 1:d(s.activeElement,{name:"middle-click-drag-start",x:e.clientX,y:e.clientY});break;case 2:d(s.activeElement,{name:"right-click-drag-start",x:e.clientX,y:e.clientY});break}if(s.isMoving=!0,s.lastX=e.clientX,s.lastY=e.clientY,s.isLongclick)d(s.activeElement,{name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 1:d(s.activeElement,{name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 2:d(s.activeElement,{name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break}},H=e=>{if(window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",H),s.lastMouseupTime=Date.now(),s.isMoving)if(s.isMoving=!1,s.isLongclick)s.isLongclick=!1,d(s.activeElement,{name:"longclick-drag-end",x:s.lastX,y:s.lastY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-end",x:s.lastX,y:s.lastY});break;case 1:d(s.activeElement,{name:"middle-click-drag-end",x:s.lastX,y:s.lastY});break;case 2:d(s.activeElement,{name:"right-click-drag-end",x:s.lastX,y:s.lastY});break}else s.isLongclick||(e.button===2?d(s.activeElement,{name:"right-click",x:e.clientX,y:e.clientY}):e.button===1?d(s.activeElement,{name:"middle-click",x:e.clientX,y:e.clientY}):(s.consecutiveClicks===0&&d(s.activeElement,{name:"left-click",x:e.clientX,y:e.clientY}),s.consecutiveClicks++,window.setTimeout(()=>{s.consecutiveClicks>1&&d(s.activeElement,{name:"double-click",x:e.clientX,y:e.clientY}),s.consecutiveClicks=0},ke)));s.isLongclick&&d(s.activeElement,{name:"longclick-release",x:e.clientX,y:e.clientY}),s.isLongclick=!1},De=e=>{if(e.touches.length>1&&(e.preventDefault(),e.stopPropagation()),document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===n.identifier)return;n.isPinching=!0}window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",X),window.addEventListener("touchcancel",X),n.identifier=e.touches[0].identifier,n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,n.activeElement=e.target,window.setTimeout(()=>{n.isPinching||n.isDragging||Date.now()-n.lastTouchendTime>=te&&(n.isDragging=!1,n.isPinching=!1,n.hypotenuse=null,n.isLongpressed=!0,d(n.activeElement,{name:"longpress",x:n.x,y:n.y}))},te)}},A=e=>{if(e.preventDefault(),e.stopPropagation(),n.isDragging){let t=n.x,i=n.y;n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let l=n.x-t,o=n.y-i;n.isLongpressed?d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:l,dy:o}):d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:l,dy:o});return}else if(!n.isLongpressed&&(n.isPinching||e.touches.length>1)){n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},i={x:(n.x+t.x)/2,y:(n.y+t.y)/2},l=Math.hypot(n.x-t.x,n.y-t.y);n.hypotenuse===null&&(n.hypotenuse=l,n.lastCenterX=i.x,n.lastCenterY=i.y,d(n.activeElement,{name:"pinch-start",x:i.x,y:i.y})),n.isPinching=!0;let o=l/n.hypotenuse,a=i.x-n.lastCenterX,r=i.y-n.lastCenterY;d(n.activeElement,{name:"pinching",x:i.x,y:i.y,zoom:o,dx:a,dy:r}),n.hypotenuse=l,n.lastCenterX=i.x,n.lastCenterY=i.y;return}else n.isDragging=!0,n.isLongpressed?(d(n.activeElement,{name:"longpress-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:0,dy:0})):(d(n.activeElement,{name:"touch-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:0,dy:0}))},X=e=>{n.isDragging&&e.touches.length>0&&e.touches[0].identifier===n.identifier||(n.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",X),window.removeEventListener("touchcancel",X),n.isDragging?(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.x,y:n.y})):d(n.activeElement,{name:"touch-drag-end",x:n.x,y:n.y})):n.isPinching?(n.isPinching=!1,n.hypotenuse=null,d(n.activeElement,{name:"pinch-end",x:n.lastCenterX,y:n.lastCenterY})):n.isLongpressed||(n.consecutiveTaps===0&&d(n.activeElement,{name:"tap",x:n.x,y:n.y}),n.consecutiveTaps++,window.setTimeout(()=>{n.consecutiveTaps>1&&d(n.activeElement,{name:"double-tap",x:n.x,y:n.y}),n.consecutiveTaps=0},Ee)),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.x,y:n.y}),n.isLongpressed=!1)};function Te(...e){for(let t of e)O.findIndex(i=>i===t)===-1&&(O.length==0&&(window.addEventListener("blur",xe),window.addEventListener("focus",Le)),O.push(t),t.addEventListener("touchstart",De,{passive:!1}),t.addEventListener("mousedown",Ce,{passive:!1}),t.addEventListener("contextmenu",Xe,{passive:!1}),t.addEventListener("wheel",Ye,{passive:!1}))}function Pe(e){let t;return{c(){t=w("canvas"),this.h()},l(i){t=b(i,"CANVAS",{id:!0,class:!0}),T(t).forEach(y),this.h()},h(){_(t,"id","canvas"),_(t,"class","svelte-12lb0mc")},m(i,l){k(i,t,l),e[6](t)},p:x,i:x,o:x,d(i){i&&y(t),e[6](null)}}}function Ie(e,t,i){let l,{radius:o=10}=t,{stroke:a=5}=t,{lineCap:r="round"}=t,{color:u="#000000"}=t,{dashed:f=!1}=t,c,h,v={x:0,y:0},V=0,G=0,C,K=function(m,E,g,N){var P=g-m,D=N-E;return Math.sqrt(P*P+D*D)};function re(){console.log("resizing"),h.resetTransform(),C=window.devicePixelRatio;let m=c.getBoundingClientRect();V=m.height*C,G=m.width*C,c.setAttribute("height",V.toString()),c.setAttribute("width",G.toString())}function J(m,E){let g=c.getBoundingClientRect();return{x:(m-g.left)*C,y:(E-g.top)*C}}function ue(m,E){h.lineWidth=a,h.lineCap=r,h.strokeStyle=u,h.setLineDash(l),h.beginPath(),v=J(m,E),h.moveTo(v.x,v.y)}function de(m,E){let g=J(m,E);if(o>0){if(K(g.x,g.y,v.x,v.y)<=o)return;let D=Math.sqrt(g.x*g.x+g.y*g.y-2*g.x*v.x+v.x*v.x-2*g.y*v.y+v.y*v.y);if(g={x:g.x+o*((v.x-g.x)/D),y:g.y+o*((v.y-g.y)/D)},K(v.x,v.y,g.x,g.y)<=.1)return}var N=(v.x+g.x)/2,P=(v.y+g.y)/2;h.quadraticCurveTo(v.x,v.y,N,P),v=g,h.stroke()}ge(()=>{h=c.getContext("2d"),Te(c),c.addEventListener("gesture",E=>{switch(E.detail.name){case"left-click-drag-start":case"touch-drag-start":ue(E.detail.x,E.detail.y);break;case"left-click-dragging":case"touch-dragging":de(E.detail.x,E.detail.y);break}}),new ResizeObserver(re).observe(c)});function fe(m){pe[m?"unshift":"push"](()=>{c=m,i(0,c)})}return e.$$set=m=>{"radius"in m&&i(1,o=m.radius),"stroke"in m&&i(2,a=m.stroke),"lineCap"in m&&i(3,r=m.lineCap),"color"in m&&i(4,u=m.color),"dashed"in m&&i(5,f=m.dashed)},e.$$.update=()=>{e.$$.dirty&36&&(l=f?[a,a*3]:[])},[c,o,a,r,u,f,fe]}class Me extends R{constructor(t){super(),U(this,t,Ie,Pe,q,{radius:1,stroke:2,lineCap:3,color:4,dashed:5})}}function ie(e,t,i){const l=e.slice();return l[5]=t[i],l[6]=t,l[7]=i,l}function Se(e){let t,i;return{c(){t=w("div"),i=le("Invalid input type!")},l(l){t=b(l,"DIV",{});var o=T(t);i=ae(o,"Invalid input type!"),o.forEach(y)},m(l,o){k(l,t,o),oe(t,i)},p:x,d(l){l&&y(t)}}}function He(e){let t,i,l;function o(){e[4].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=b(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","checkbox"),_(t,"class","svelte-1e5ubmd")},m(a,r){k(a,t,r),t.checked=e[5].value,i||(l=[L(t,"change",o),L(t,"input",function(){I(e[5].onInput(!e[5].value))&&e[5].onInput(!e[5].value).apply(this,arguments)})],i=!0)},p(a,r){e=a,r&1&&(t.checked=e[5].value)},d(a){a&&y(t),i=!1,M(l)}}}function Ae(e){let t,i,l;function o(){e[3].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=b(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","color"),_(t,"class","svelte-1e5ubmd")},m(a,r){k(a,t,r),Y(t,e[5].value),i||(l=[L(t,"input",o),L(t,"input",function(){I(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,r){e=a,r&1&&Y(t,e[5].value)},d(a){a&&y(t),i=!1,M(l)}}}function Ne(e){let t,i,l;function o(){e[2].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=b(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","text"),_(t,"class","svelte-1e5ubmd")},m(a,r){k(a,t,r),Y(t,e[5].value),i||(l=[L(t,"input",o),L(t,"input",function(){I(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,r){e=a,r&1&&t.value!==e[5].value&&Y(t,e[5].value)},d(a){a&&y(t),i=!1,M(l)}}}function Oe(e){let t,i,l;function o(){e[1].call(t,e[6],e[7])}return{c(){t=w("input"),this.h()},l(a){t=b(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","number"),_(t,"class","svelte-1e5ubmd")},m(a,r){k(a,t,r),Y(t,e[5].value),i||(l=[L(t,"input",o),L(t,"input",function(){I(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,r){e=a,r&1&&ce(t.value)!==e[5].value&&Y(t,e[5].value)},d(a){a&&y(t),i=!1,M(l)}}}function se(e){let t,i=e[5].title+"",l,o,a;function r(c,h){return c[5].type=="number"?Oe:c[5].type=="string"?Ne:c[5].type=="color"?Ae:c[5].type=="checkbox"?He:Se}let u=r(e),f=u(e);return{c(){t=w("label"),l=le(i),o=z(),f.c(),a=Q(),this.h()},l(c){t=b(c,"LABEL",{for:!0,class:!0});var h=T(t);l=ae(h,i),h.forEach(y),o=B(c),f.l(c),a=Q(),this.h()},h(){_(t,"for",e[7].toString()),_(t,"class","svelte-1e5ubmd")},m(c,h){k(c,t,h),oe(t,l),k(c,o,h),f.m(c,h),k(c,a,h)},p(c,h){h&1&&i!==(i=c[5].title+"")&&ye(l,i),u===(u=r(c))&&f?f.p(c,h):(f.d(1),f=u(c),f&&(f.c(),f.m(a.parentNode,a)))},d(c){c&&y(t),c&&y(o),f.d(c),c&&y(a)}}}function ze(e){let t,i=e[0],l=[];for(let o=0;o<i.length;o+=1)l[o]=se(ie(e,i,o));return{c(){t=w("div");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){t=b(o,"DIV",{class:!0});var a=T(t);for(let r=0;r<l.length;r+=1)l[r].l(a);a.forEach(y),this.h()},h(){_(t,"class","container svelte-1e5ubmd")},m(o,a){k(o,t,a);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(t,null)},p(o,[a]){if(a&1){i=o[0];let r;for(r=0;r<i.length;r+=1){const u=ie(o,i,r);l[r]?l[r].p(u,a):(l[r]=se(u),l[r].c(),l[r].m(t,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=i.length}},i:x,o:x,d(o){o&&y(t),ve(l,o)}}}function Be(e,t,i){let{props:l}=t;function o(f,c){f[c].value=ce(this.value),i(0,l)}function a(f,c){f[c].value=this.value,i(0,l)}function r(f,c){f[c].value=this.value,i(0,l)}function u(f,c){f[c].value=this.checked,i(0,l)}return e.$$set=f=>{"props"in f&&i(0,l=f.props)},[l,o,a,r,u]}class Re extends R{constructor(t){super(),U(this,t,Be,ze,q,{props:0})}}function Ue(e){let t,i,l,o,a,r;return l=new Re({props:{props:[{title:"Stroke",type:"number",onInput:e[3],value:e[0]},{title:"Color",type:"color",onInput:e[4],value:e[1]},{title:"Dashed",type:"checkbox",onInput:e[5],value:e[2]}]}}),a=new Me({props:{dashed:e[2],color:e[1],stroke:e[0]}}),{c(){t=z(),i=w("div"),W(l.$$.fragment),o=z(),W(a.$$.fragment),this.h()},l(u){_e("svelte-94kuob",document.head).forEach(y),t=B(u),i=b(u,"DIV",{class:!0});var c=T(i);j(l.$$.fragment,c),c.forEach(y),o=B(u),j(a.$$.fragment,u),this.h()},h(){document.title="Draw",_(i,"class","inputs-container svelte-faw9g8")},m(u,f){k(u,t,f),k(u,i,f),F(l,i,null),k(u,o,f),F(a,u,f),r=!0},p(u,[f]){const c={};f&7&&(c.props=[{title:"Stroke",type:"number",onInput:u[3],value:u[0]},{title:"Color",type:"color",onInput:u[4],value:u[1]},{title:"Dashed",type:"checkbox",onInput:u[5],value:u[2]}]),l.$set(c);const h={};f&4&&(h.dashed=u[2]),f&2&&(h.color=u[1]),f&1&&(h.stroke=u[0]),a.$set(h)},i(u){r||(Z(l.$$.fragment,u),Z(a.$$.fragment,u),r=!0)},o(u){$(l.$$.fragment,u),$(a.$$.fragment,u),r=!1},d(u){u&&y(t),u&&y(i),ee(l),u&&y(o),ee(a,u)}}}function qe(e,t,i){let l=5,o="#ff0000",a=!1;return[l,o,a,c=>{c!=null&&i(0,l=c)},c=>{c!=null&&i(1,o=c)},c=>{c!=null&&i(2,a=c)}]}class Je extends R{constructor(t){super(),U(this,t,qe,Ue,q,{})}}export{Je as component};
