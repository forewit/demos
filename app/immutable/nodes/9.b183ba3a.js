var Ee=Object.defineProperty;var ke=(e,t,i)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var v=(e,t,i)=>(ke(e,typeof t!="symbol"?t+"":t,i),i);import{S as J,i as Q,s as j,k as b,l as L,m as M,h as y,n as _,b as k,J as X,o as we,w as be,R as Le,q as de,a as K,e as ee,r as fe,c as W,E as he,u as xe,Q as me,O as x,T as N,P as O,N as C,y as te,D as Ye,z as ne,A as ie,g as se,d as le,B as ae}from"../chunks/index.513dcc03.js";const oe=500,Xe=300,re=500,Ce=300;class De{constructor(){v(this,"isMoving",!1);v(this,"isLongclick",!1);v(this,"button",0);v(this,"lastX",0);v(this,"lastY",0);v(this,"consecutiveClicks",0);v(this,"lastMouseupTime",0);v(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Te{constructor(){v(this,"isDragging",!1);v(this,"isPinching",!1);v(this,"isLongpressed",!1);v(this,"consecutiveTaps",0);v(this,"lastTouchendTime",0);v(this,"lastCenterX",0);v(this,"lastCenterY",0);v(this,"identifier",0);v(this,"x",0);v(this,"y",0);v(this,"hypotenuse",0);v(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let G=[],s=new De,n=new Te;const d=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},Ie=e=>{s.reset(),n.reset(),s.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",R),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",D)},Pe=e=>{if(window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",R),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",D),s.isMoving)if(s.isMoving=!1,s.isLongclick)s.isLongclick=!1,d(s.activeElement,{name:"longclick-drag-end",x:s.lastX,y:s.lastY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-end",x:s.lastX,y:s.lastY});break;case 1:d(s.activeElement,{name:"middle-click-drag-end",x:s.lastX,y:s.lastY});break;case 2:d(s.activeElement,{name:"right-click-drag-end",x:s.lastX,y:s.lastY});break}s.isLongclick&&d(s.activeElement,{name:"longclick-release",x:s.lastX,y:s.lastY}),s.reset(),n.isDragging&&(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.lastCenterX,y:n.lastCenterY})):d(n.activeElement,{name:"touch-drag-end",x:n.lastCenterX,y:n.lastCenterY})),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.lastCenterX,y:n.lastCenterY}),n.reset()},Me=e=>{d(e.target,{name:"wheel",x:e.clientX,y:e.clientY,event:e}),e.preventDefault(),e.stopPropagation()},Se=e=>{e.preventDefault(),e.stopPropagation()},He=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",z),window.addEventListener("mouseup",R),s.activeElement=e.target,s.lastX=e.clientX,s.lastY=e.clientY,s.isMoving||(s.button=e.button),s.button===0&&window.setTimeout(()=>{Date.now()-s.lastMouseupTime>=re&&!s.isMoving&&(s.isLongclick=!0,d(s.activeElement,{name:"longclick",x:e.clientX,y:e.clientY}))},re),e.preventDefault(),e.stopPropagation())},z=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-s.lastX,i=e.clientY-s.lastY;if(!s.isMoving)if(s.isLongclick)d(s.activeElement,{name:"longclick-drag-start",x:e.clientX,y:e.clientY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-start",x:e.clientX,y:e.clientY});break;case 1:d(s.activeElement,{name:"middle-click-drag-start",x:e.clientX,y:e.clientY});break;case 2:d(s.activeElement,{name:"right-click-drag-start",x:e.clientX,y:e.clientY});break}if(s.isMoving=!0,s.lastX=e.clientX,s.lastY=e.clientY,s.isLongclick)d(s.activeElement,{name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 1:d(s.activeElement,{name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break;case 2:d(s.activeElement,{name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:i});break}},R=e=>{if(window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",R),s.lastMouseupTime=Date.now(),s.isMoving)if(s.isMoving=!1,s.isLongclick)s.isLongclick=!1,d(s.activeElement,{name:"longclick-drag-end",x:s.lastX,y:s.lastY});else switch(s.button){case 0:d(s.activeElement,{name:"left-click-drag-end",x:s.lastX,y:s.lastY});break;case 1:d(s.activeElement,{name:"middle-click-drag-end",x:s.lastX,y:s.lastY});break;case 2:d(s.activeElement,{name:"right-click-drag-end",x:s.lastX,y:s.lastY});break}else s.isLongclick||(e.button===2?d(s.activeElement,{name:"right-click",x:e.clientX,y:e.clientY}):e.button===1?d(s.activeElement,{name:"middle-click",x:e.clientX,y:e.clientY}):(s.consecutiveClicks===0&&d(s.activeElement,{name:"left-click",x:e.clientX,y:e.clientY}),s.consecutiveClicks++,window.setTimeout(()=>{s.consecutiveClicks>1&&d(s.activeElement,{name:"double-click",x:e.clientX,y:e.clientY}),s.consecutiveClicks=0},Ce)));s.isLongclick&&d(s.activeElement,{name:"longclick-release",x:e.clientX,y:e.clientY}),s.isLongclick=!1},Ae=e=>{if(e.touches.length>1&&(e.preventDefault(),e.stopPropagation()),document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===n.identifier)return;n.isPinching=!0}window.addEventListener("touchmove",U,{passive:!1}),window.addEventListener("touchend",D),window.addEventListener("touchcancel",D),n.identifier=e.touches[0].identifier,n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,n.activeElement=e.target,window.setTimeout(()=>{n.isPinching||n.isDragging||Date.now()-n.lastTouchendTime>=oe&&(n.isDragging=!1,n.isPinching=!1,n.hypotenuse=null,n.isLongpressed=!0,d(n.activeElement,{name:"longpress",x:n.x,y:n.y}))},oe)}},U=e=>{if(e.preventDefault(),e.stopPropagation(),n.isDragging){let t=n.x,i=n.y;n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let l=n.x-t,r=n.y-i;n.isLongpressed?d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:l,dy:r}):d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:l,dy:r});return}else if(!n.isLongpressed&&(n.isPinching||e.touches.length>1)){n.x=e.touches[0].clientX,n.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},i={x:(n.x+t.x)/2,y:(n.y+t.y)/2},l=Math.hypot(n.x-t.x,n.y-t.y);n.hypotenuse===null&&(n.hypotenuse=l,n.lastCenterX=i.x,n.lastCenterY=i.y,d(n.activeElement,{name:"pinch-start",x:i.x,y:i.y})),n.isPinching=!0;let r=l/n.hypotenuse,a=i.x-n.lastCenterX,c=i.y-n.lastCenterY;d(n.activeElement,{name:"pinching",x:i.x,y:i.y,zoom:r,dx:a,dy:c}),n.hypotenuse=l,n.lastCenterX=i.x,n.lastCenterY=i.y;return}else n.isDragging=!0,n.isLongpressed?(d(n.activeElement,{name:"longpress-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"longpress-dragging",x:n.x,y:n.y,dx:0,dy:0})):(d(n.activeElement,{name:"touch-drag-start",x:n.x,y:n.y}),n.x=e.touches[0].clientX,n.y=e.touches[0].clientY,d(n.activeElement,{name:"touch-dragging",x:n.x,y:n.y,dx:0,dy:0}))},D=e=>{n.isDragging&&e.touches.length>0&&e.touches[0].identifier===n.identifier||(n.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",D),window.removeEventListener("touchcancel",D),n.isDragging?(n.isDragging=!1,n.isLongpressed?(n.isLongpressed=!1,d(n.activeElement,{name:"longpress-drag-end",x:n.x,y:n.y})):d(n.activeElement,{name:"touch-drag-end",x:n.x,y:n.y})):n.isPinching?(n.isPinching=!1,n.hypotenuse=null,d(n.activeElement,{name:"pinch-end",x:n.lastCenterX,y:n.lastCenterY})):n.isLongpressed||(n.consecutiveTaps===0&&d(n.activeElement,{name:"tap",x:n.x,y:n.y}),n.consecutiveTaps++,window.setTimeout(()=>{n.consecutiveTaps>1&&d(n.activeElement,{name:"double-tap",x:n.x,y:n.y}),n.consecutiveTaps=0},Xe)),n.isLongpressed&&d(n.activeElement,{name:"longpress-release",x:n.x,y:n.y}),n.isLongpressed=!1)};function Ne(...e){for(let t of e)G.findIndex(i=>i===t)===-1&&(G.length==0&&(window.addEventListener("blur",Pe),window.addEventListener("focus",Ie)),G.push(t),t.addEventListener("touchstart",Ae,{passive:!1}),t.addEventListener("mousedown",He,{passive:!1}),t.addEventListener("contextmenu",Se,{passive:!1}),t.addEventListener("wheel",Me,{passive:!1}))}function Oe(e){let t;return{c(){t=b("canvas"),this.h()},l(i){t=L(i,"CANVAS",{id:!0,class:!0}),M(t).forEach(y),this.h()},h(){_(t,"id","canvas"),_(t,"class","svelte-16hz5p5")},m(i,l){k(i,t,l),e[6](t)},p:X,i:X,o:X,d(i){i&&y(t),e[6](null)}}}function ze(e,t,i){let l,{radius:r=10}=t,{stroke:a=5}=t,{lineCap:c="round"}=t,{color:u="#000000"}=t,{dashed:f=!1}=t,o,h,Y,q,w,p={x:0,y:0},S=0,H=0,T,B=!1,V,F=function(m,E,g,A){var I=g-m,P=A-E;return Math.sqrt(I*I+P*P)};async function ge(){console.log("resizing"),await $(),T=window.devicePixelRatio;let m=o.getBoundingClientRect(),E=S,g=H;S=m.height*T,H=m.width*T,i(0,o.width=H,o),i(0,o.height=S,o),w.onload=()=>{h.drawImage(w,0,0,g,E),Y.width=H,Y.height=S},w.src=Y.toDataURL()}function Z(m,E){let g=o.getBoundingClientRect();return{x:(m-g.left)*T,y:(E-g.top)*T}}function pe(m,E){B=!0,V={points:[],stroke:a,lineCap:c,color:u,dash:l},h.lineWidth=a,h.lineCap=c,h.strokeStyle=u,h.setLineDash(l),h.beginPath(),p=Z(m,E),h.moveTo(p.x,p.y),V.points.push(p)}function ve(m,E){if(!B)return;let g=Z(m,E);if(r>0){if(F(g.x,g.y,p.x,p.y)<=r)return;let P=Math.sqrt(g.x*g.x+g.y*g.y-2*g.x*p.x+p.x*p.x-2*g.y*p.y+p.y*p.y);if(g={x:g.x+r*((p.x-g.x)/P),y:g.y+r*((p.y-g.y)/P)},F(p.x,p.y,g.x,g.y)<=.1)return}var A=(p.x+g.x)/2,I=(p.y+g.y)/2;h.quadraticCurveTo(p.x,p.y,A,I),p=g,h.stroke(),V.points.push({x:A,y:I},g)}async function $(){B=!1,await ye()}function ye(){return new Promise((m,E)=>{w.onload=()=>{q.drawImage(w,0,0,Y.width,Y.height),m(w)},w.onerror=E,w.src=o.toDataURL()})}we(()=>{h=o.getContext("2d"),h.imageSmoothingEnabled=!1,Y=document.createElement("canvas"),q=Y.getContext("2d"),q.imageSmoothingEnabled=!1,w=new Image,Ne(o),o.addEventListener("gesture",E=>{switch(E.detail.name){case"left-click-drag-start":case"touch-drag-start":pe(E.detail.x,E.detail.y);break;case"left-click-dragging":case"touch-dragging":ve(E.detail.x,E.detail.y);break;case"left-click-drag-end":case"tough-drag-end":$();break}}),new ResizeObserver(ge).observe(o)});function _e(m){be[m?"unshift":"push"](()=>{o=m,i(0,o)})}return e.$$set=m=>{"radius"in m&&i(1,r=m.radius),"stroke"in m&&i(2,a=m.stroke),"lineCap"in m&&i(3,c=m.lineCap),"color"in m&&i(4,u=m.color),"dashed"in m&&i(5,f=m.dashed)},e.$$.update=()=>{e.$$.dirty&36&&(l=f?[a,a*3]:[])},[o,r,a,c,u,f,_e]}class Re extends J{constructor(t){super(),Q(this,t,ze,Oe,j,{radius:1,stroke:2,lineCap:3,color:4,dashed:5})}}function ce(e,t,i){const l=e.slice();return l[5]=t[i],l[6]=t,l[7]=i,l}function Ue(e){let t,i;return{c(){t=b("div"),i=de("Invalid input type!")},l(l){t=L(l,"DIV",{});var r=M(t);i=fe(r,"Invalid input type!"),r.forEach(y)},m(l,r){k(l,t,r),he(t,i)},p:X,d(l){l&&y(t)}}}function qe(e){let t,i,l;function r(){e[4].call(t,e[6],e[7])}return{c(){t=b("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","checkbox"),_(t,"class","svelte-12frump")},m(a,c){k(a,t,c),t.checked=e[5].value,i||(l=[x(t,"change",r),x(t,"input",function(){N(e[5].onInput(!e[5].value))&&e[5].onInput(!e[5].value).apply(this,arguments)})],i=!0)},p(a,c){e=a,c&1&&(t.checked=e[5].value)},d(a){a&&y(t),i=!1,O(l)}}}function Be(e){let t,i,l;function r(){e[3].call(t,e[6],e[7])}return{c(){t=b("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","color"),_(t,"class","svelte-12frump")},m(a,c){k(a,t,c),C(t,e[5].value),i||(l=[x(t,"input",r),x(t,"input",function(){N(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,c){e=a,c&1&&C(t,e[5].value)},d(a){a&&y(t),i=!1,O(l)}}}function Ve(e){let t,i,l;function r(){e[2].call(t,e[6],e[7])}return{c(){t=b("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","text"),_(t,"class","svelte-12frump")},m(a,c){k(a,t,c),C(t,e[5].value),i||(l=[x(t,"input",r),x(t,"input",function(){N(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,c){e=a,c&1&&t.value!==e[5].value&&C(t,e[5].value)},d(a){a&&y(t),i=!1,O(l)}}}function Ge(e){let t,i,l;function r(){e[1].call(t,e[6],e[7])}return{c(){t=b("input"),this.h()},l(a){t=L(a,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){_(t,"id",e[7].toString()),_(t,"type","number"),_(t,"class","svelte-12frump")},m(a,c){k(a,t,c),C(t,e[5].value),i||(l=[x(t,"input",r),x(t,"input",function(){N(e[5].onInput(e[5].value))&&e[5].onInput(e[5].value).apply(this,arguments)})],i=!0)},p(a,c){e=a,c&1&&me(t.value)!==e[5].value&&C(t,e[5].value)},d(a){a&&y(t),i=!1,O(l)}}}function ue(e){let t,i=e[5].title+"",l,r,a;function c(o,h){return o[5].type=="number"?Ge:o[5].type=="string"?Ve:o[5].type=="color"?Be:o[5].type=="checkbox"?qe:Ue}let u=c(e),f=u(e);return{c(){t=b("label"),l=de(i),r=K(),f.c(),a=ee(),this.h()},l(o){t=L(o,"LABEL",{for:!0,class:!0});var h=M(t);l=fe(h,i),h.forEach(y),r=W(o),f.l(o),a=ee(),this.h()},h(){_(t,"for",e[7].toString()),_(t,"class","svelte-12frump")},m(o,h){k(o,t,h),he(t,l),k(o,r,h),f.m(o,h),k(o,a,h)},p(o,h){h&1&&i!==(i=o[5].title+"")&&xe(l,i),u===(u=c(o))&&f?f.p(o,h):(f.d(1),f=u(o),f&&(f.c(),f.m(a.parentNode,a)))},d(o){o&&y(t),o&&y(r),f.d(o),o&&y(a)}}}function Ke(e){let t,i=e[0],l=[];for(let r=0;r<i.length;r+=1)l[r]=ue(ce(e,i,r));return{c(){t=b("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){t=L(r,"DIV",{class:!0});var a=M(t);for(let c=0;c<l.length;c+=1)l[c].l(a);a.forEach(y),this.h()},h(){_(t,"class","container svelte-12frump")},m(r,a){k(r,t,a);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(t,null)},p(r,[a]){if(a&1){i=r[0];let c;for(c=0;c<i.length;c+=1){const u=ce(r,i,c);l[c]?l[c].p(u,a):(l[c]=ue(u),l[c].c(),l[c].m(t,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=i.length}},i:X,o:X,d(r){r&&y(t),Le(l,r)}}}function We(e,t,i){let{props:l}=t;function r(f,o){f[o].value=me(this.value),i(0,l)}function a(f,o){f[o].value=this.value,i(0,l)}function c(f,o){f[o].value=this.value,i(0,l)}function u(f,o){f[o].value=this.checked,i(0,l)}return e.$$set=f=>{"props"in f&&i(0,l=f.props)},[l,r,a,c,u]}class Je extends J{constructor(t){super(),Q(this,t,We,Ke,j,{props:0})}}function Qe(e){let t,i,l,r,a,c;return l=new Je({props:{props:[{title:"Stroke",type:"number",onInput:e[3],value:e[0]},{title:"Color",type:"color",onInput:e[4],value:e[1]},{title:"Dashed",type:"checkbox",onInput:e[5],value:e[2]}]}}),a=new Re({props:{dashed:e[2],color:e[1],stroke:e[0]}}),{c(){t=K(),i=b("div"),te(l.$$.fragment),r=K(),te(a.$$.fragment),this.h()},l(u){Ye("svelte-94kuob",document.head).forEach(y),t=W(u),i=L(u,"DIV",{class:!0});var o=M(i);ne(l.$$.fragment,o),o.forEach(y),r=W(u),ne(a.$$.fragment,u),this.h()},h(){document.title="Draw",_(i,"class","inputs-container svelte-igcq23")},m(u,f){k(u,t,f),k(u,i,f),ie(l,i,null),k(u,r,f),ie(a,u,f),c=!0},p(u,[f]){const o={};f&7&&(o.props=[{title:"Stroke",type:"number",onInput:u[3],value:u[0]},{title:"Color",type:"color",onInput:u[4],value:u[1]},{title:"Dashed",type:"checkbox",onInput:u[5],value:u[2]}]),l.$set(o);const h={};f&4&&(h.dashed=u[2]),f&2&&(h.color=u[1]),f&1&&(h.stroke=u[0]),a.$set(h)},i(u){c||(se(l.$$.fragment,u),se(a.$$.fragment,u),c=!0)},o(u){le(l.$$.fragment,u),le(a.$$.fragment,u),c=!1},d(u){u&&y(t),u&&y(i),ae(l),u&&y(r),ae(a,u)}}}function je(e,t,i){let l=5,r="#ff0000",a=!1;return[l,r,a,o=>{o!=null&&i(0,l=o)},o=>{o!=null&&i(1,r=o)},o=>{o!=null&&i(2,a=o)}]}class et extends J{constructor(t){super(),Q(this,t,je,Qe,j,{})}}export{et as component};
